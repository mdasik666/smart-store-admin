"use strict";(self.webpackChunkss_react=self.webpackChunkss_react||[]).push([[139],{1139:(e,t,i)=>{i.r(t),i.d(t,{default:()=>G});var n=i(1582),a=i(4294),r=i(4721),s=i(5527),o=i(3044),l=i(3400),d=i(5711),c=i(890),u=i(8550),g=i(8096),m=i(4925),p=i(9321),h=i(3786),v=i(7071),y=i(3239),x=i(3543),j=i(9658),Z=i(1691),f=i(9836),w=i(3382),b=i(3994),P=i(9281),A=i(6890),C=i(6812),S=i(5855),k=i(2791),q=i(9823),T=i(1134),I=i(9020),N=i(7689),z=i(4091),O=i(5397),L=i(8087),_=i(5289),W=i(7123),D=i(9157),R=i(5661),F=i(184);const U=function(e){let{open:t,onClose:i,onConfirm:n,title:r,dividers:s,children:o}=e;return(0,F.jsxs)(_.Z,{open:t,children:[(0,F.jsx)(R.Z,{children:r}),(0,F.jsx)(D.Z,{dividers:s,children:o}),(0,F.jsxs)(W.Z,{children:[(0,F.jsx)(a.Z,{onClick:i,variant:"contained",color:"error",children:"Cancel"}),(0,F.jsx)(a.Z,{onClick:n,variant:"contained",color:"primary",children:"Confirm"})]})]})};i(5827);const B=e=>new Promise(((t,i)=>{const n=e,a=URL.createObjectURL(n),r=new Image;r.src=a,r.onerror=function(e){URL.revokeObjectURL(r.src)},r.onload=function(){URL.revokeObjectURL(r.src);const[e,i]=function(e,t,i){let n=e.width,a=e.height;n>a?n>t&&(a=Math.round(a*t/n),n=t):a>i&&(n=Math.round(n*i/a),a=i);return[n,a]}(r,320,180),n=document.createElement("canvas");n.width=e,n.height=i;const a=n.getContext("2d");a&&(null===a||void 0===a||a.drawImage(r,0,0,e,i),n.toBlob((e=>{const i=new FileReader;i.onloadend=function(){const e=i.result;t(e)},i.readAsDataURL(e)}),"image/jpeg",.9))}})),G=()=>{var e,t,i,_,W,D,R,G;const[E,M]=(0,k.useState)([]),V=["Gram","KG","Pieces","Packet"],H=(0,N.s0)(),{register:J,handleSubmit:Q,control:$,formState:{errors:K,isValid:X},reset:Y,setValue:ee,unregister:te}=(0,T.cI)({mode:"onChange"}),[ie,ne]=(0,k.useState)(!1),[ae,re]=(0,k.useState)(!1),[se,oe]=(0,k.useState)(!1),[le,de]=(0,k.useState)({open:!1,severity:void 0,message:""}),[ce,ue]=(0,k.useState)(!1),[ge,me]=(0,k.useState)(""),[pe,he]=(0,k.useState)(""),[ve,ye]=(0,k.useState)([]),[xe,je]=(0,k.useState)([]),[Ze,fe]=(0,k.useState)(""),[we,be]=(0,k.useState)([{price:0,quantity:"",type:""}]),Pe=(e,t)=>{"clickaway"!==t&&de({open:!1,severity:void 0,message:""})};(0,k.useEffect)((()=>{!async function(){if(localStorage.getItem("admintoken"))try{ne(!0);const e=await(0,I.mT)(String(localStorage.getItem("admintoken")));if("Failed"===e.data.status)H("/admin/login");else{he(e.data.data._id);const t=await(0,I.w3)(e.data.data._id);if("Success"===t.data.status){ye(t.data.productList);const e=await(0,I.kN)();if("Success"===e.data.status){M(e.data.category);const{_id:i,productName:n,productDescription:a,category:r,title:s,quantityAndTypeAndPrice:o,minOrder:l,image:d}=t.data.productList[0];je(Object.keys({_id:i,productName:n,productDescription:a,category:r,title:s,quantityAndTypeAndPrice:o,minOrder:l,image:d}))}else de({open:!0,severity:"error",message:e.data.message})}else de({open:!0,severity:"error",message:t.data.message})}ne(!1)}catch(e){de({open:!1,severity:"warning",message:null===e||void 0===e?void 0:e.messsage}),ne(!1)}else H("/admin/login")}()}),[H]);const[Ae,Ce]=(0,k.useState)(0),[Se,ke]=(0,k.useState)(5),[qe,Te]=(0,k.useState)(!1),Ie=()=>{Te(!1)},Ne=e=>{fe(e),Te(!0)},ze=()=>{me(""),be([{price:0,quantity:"",type:""}]),Y()},Oe=(e,t)=>{if("add"===e)be((e=>[...e,{price:0,quantity:"",type:""}]));else if("delete"===e&&we.length>0){var i=[...we.slice(0,t),...we.slice(t+1,we.length)];be(i),ee("quantityAndTypeAndPrice",i)}};return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsxs)(n.Z,{spacing:2,children:[(0,F.jsx)(n.Z,{children:(0,F.jsx)(a.Z,{variant:"contained",onClick:()=>{fe(""),ue(!0)},children:"Add Product"})}),(0,F.jsx)(r.Z,{}),(0,F.jsx)(n.Z,{spacing:2,direction:"column",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",children:ie?(0,F.jsx)("div",{children:"Loading..."}):ve.length?(0,F.jsxs)(s.Z,{sx:{width:"100%",overflow:"hidden"},children:[(0,F.jsx)(P.Z,{children:(0,F.jsxs)(f.Z,{stickyHeader:!0,"aria-label":"sticky table",children:[(0,F.jsx)(A.Z,{children:(0,F.jsxs)(S.Z,{children:[null===xe||void 0===xe?void 0:xe.map(((e,t)=>"_id"!==e&&(0,F.jsx)(b.Z,{align:"center",sx:{textTransform:"capitalize",bgcolor:"black",color:"white"},children:e.replace(/([A-Z])/g," $1")},t))),(0,F.jsx)(b.Z,{align:"center",sx:{textTransform:"capitalize",bgcolor:"black",color:"white"},children:"Actions"},xe.length)]})}),(0,F.jsx)(w.Z,{children:ve.slice(Ae*Se,Ae*Se+Se).map((e=>(0,F.jsxs)(S.Z,{hover:!0,role:"checkbox",tabIndex:-1,children:[null===xe||void 0===xe?void 0:xe.map(((t,i)=>{var a,r;return"_id"!==t&&("quantityAndTypeAndPrice"===t?(0,F.jsx)(b.Z,{align:"center",children:(0,F.jsx)(n.Z,{direction:"column",alignItems:"center",justifyContent:"center",children:e.quantityAndTypeAndPrice.map(((e,t)=>{let{price:i,quantity:a,type:r}=e;return(0,F.jsxs)(n.Z,{children:[a," - ",null===i||void 0===i?void 0:i.toString()," - ",r]},t)}))})},i):null!==(a=String(e[t]))&&void 0!==a&&a.startsWith("data:image")?(0,F.jsx)(b.Z,{align:"center",sx:{display:"flex",justifyContent:"center"},children:(0,F.jsx)(o.Z,{src:null===(r=e[t])||void 0===r?void 0:r.toString(),alt:"image"})},i):(0,F.jsx)(b.Z,{align:"center",children:e[t]},i))})),(0,F.jsx)(b.Z,{align:"center",children:(0,F.jsxs)(n.Z,{direction:"row",justifyContent:"center",alignItems:"center",width:"100%",children:[(0,F.jsx)(l.Z,{onClick:()=>(async e=>{te("image"),fe(e);const t=ve.filter((t=>e===t._id))[0];ee("productName",t.productName),ee("productDescription",t.productDescription),me(t.category),ee("category",t.category),ee("title",t.title),be(t.quantityAndTypeAndPrice),ee("quantityAndTypeAndPrice",t.quantityAndTypeAndPrice),ee("minOrder",t.minOrder),ue(!0)})(e._id),children:(0,F.jsx)(z.Z,{})}),(0,F.jsx)(l.Z,{disabled:se,onClick:()=>Ne(e._id),children:(0,F.jsx)(O.Z,{})})]})},xe.length)]},e._id)))})]})}),(0,F.jsx)(C.Z,{rowsPerPageOptions:[5,10,25,100],component:"div",count:ve.length,rowsPerPage:Se,page:Ae,onPageChange:(e,t)=>{Ce(t)},onRowsPerPageChange:e=>{ke(+e.target.value),Ce(0)}})]}):(0,F.jsx)("div",{children:"Product Not Found"})})]}),(0,F.jsx)(d.Z,{disableEnforceFocus:!0,open:ce,children:(0,F.jsx)(n.Z,{position:"absolute",top:"50%",left:"50%",width:{xs:"90%",sm:"80%",md:"50%"},sx:{transform:"translate(-50%, -50%)"},children:(0,F.jsxs)(n.Z,{component:s.Z,sx:{position:"relative"},p:4,direction:"column",alignItems:"center",justifyContent:"center",children:[(0,F.jsx)(l.Z,{sx:{position:"absolute",top:0,right:0,mr:0},edge:"end",color:"inherit",onClick:()=>{fe(""),ue(!1)},children:(0,F.jsx)(q.Z,{})}),(0,F.jsx)(c.Z,{component:s.Z,mb:2,gutterBottom:!0,variant:"h5",textAlign:"center",bgcolor:"#000",color:"#fff",width:"100%",children:Ze.length>0?"Update Product":"Add Product"}),(0,F.jsx)("form",{onSubmit:Q((async e=>{try{var t;if(re(!0),Ze.length>0?e.image[0]?(e.image=await B(e.image[0]),t=await(0,I.rA)(Ze,e)):(delete e.image,t=await(0,I.rA)(Ze,e)):(e.image=await B(e.image[0]),e.adminId=pe,t=await(0,I.jp)(e)),"Failed"===t.data.status)de({open:!0,severity:"error",message:t.data.message}),re(!1);else{de({open:!0,severity:"success",message:t.data.message}),Ze.length>0?(fe(""),ue(!1),ze()):ze(),re(!1);const e=await(0,I.w3)(pe);if("Success"===e.data.status){if(ye(e.data.productList),1===e.data.productList.length){const{_id:t,productName:i,productDescription:n,category:a,title:r,quantityAndTypeAndPrice:s,minOrder:o,image:l}=e.data.productList[0];je(Object.keys({_id:t,productName:i,productDescription:n,category:a,title:r,quantityAndTypeAndPrice:s,minOrder:o,image:l}))}}else de({open:!0,severity:"error",message:e.data.message})}}catch(i){de({open:!1,severity:"warning",message:null===i||void 0===i?void 0:i.messsage}),re(!1)}})),children:(0,F.jsxs)(n.Z,{spacing:2,direction:"column",width:"100%",children:[(0,F.jsxs)(n.Z,{spacing:2,direction:"row",width:"100%",children:[(0,F.jsx)(u.Z,{fullWidth:!0,error:Boolean(null===K||void 0===K?void 0:K.productName),helperText:(null===K||void 0===K?void 0:K.productName)&&(null===(e=K.productName)||void 0===e||null===(t=e.message)||void 0===t?void 0:t.toString()),size:"small",...J("productName",{required:"Product Name is mandatory"}),variant:"outlined",type:"text",label:"Product Name"}),(0,F.jsx)(u.Z,{fullWidth:!0,size:"small",...J("productDescription"),variant:"outlined",type:"text",label:"Product Description"})]}),(0,F.jsxs)(n.Z,{spacing:2,direction:"row",width:"100%",children:[(0,F.jsxs)(g.Z,{fullWidth:!0,size:"small",error:Boolean(null===K||void 0===K?void 0:K.category),children:[(0,F.jsx)(m.Z,{id:"category",children:"Category"}),(0,F.jsx)(p.Z,{labelId:"category",...J("category",{required:"Category is mandatory"}),onChange:e=>{me(e.target.value)},value:ge,label:"Category",children:E.length&&E.map(((e,t)=>(0,F.jsx)(h.Z,{value:e.categoryName,children:null===e||void 0===e?void 0:e.categoryName},t)))}),(0,F.jsx)(v.Z,{children:(null===K||void 0===K?void 0:K.category)&&(null===(i=K.category)||void 0===i||null===(_=i.message)||void 0===_?void 0:_.toString())})]}),(0,F.jsx)(u.Z,{fullWidth:!0,size:"small",...J("title"),variant:"outlined",type:"text",label:"Title"})]}),we.map(((e,t)=>{var i,r,s,o,l,d,c;return(0,F.jsxs)(n.Z,{width:"100%",direction:"row",spacing:1,children:[(0,F.jsx)(u.Z,{fullWidth:!0,...J("quantityAndTypeAndPrice[".concat(t,"].price"),{required:"Price is mandatory"}),error:Boolean(null===K||void 0===K||null===(i=K.quantityAndTypeAndPrice)||void 0===i||null===(r=i[t])||void 0===r?void 0:r.price),helperText:(null===K||void 0===K||null===(s=K.quantityAndTypeAndPrice)||void 0===s||null===(o=s[t])||void 0===o?void 0:o.price)&&(null===(l=K.quantityAndTypeAndPrice)||void 0===l||null===(d=l[t].price)||void 0===d||null===(c=d.message)||void 0===c?void 0:c.toString()),size:"small",variant:"outlined",type:"number",label:"Price"}),(0,F.jsx)(u.Z,{fullWidth:!0,...J("quantityAndTypeAndPrice[".concat(t,"].quantity"),{pattern:{value:/^[0-9]*\.?[0-9]*$/,message:"Enter a valid number"}}),size:"small",variant:"outlined",type:"text",label:"Quantity"}),(0,F.jsxs)(g.Z,{fullWidth:!0,size:"small",children:[(0,F.jsx)(m.Z,{id:"qtype-".concat(t),children:"Type"}),(0,F.jsx)(T.Qr,{name:"quantityAndTypeAndPrice[".concat(t,"].type"),control:$,defaultValue:e.type,render:e=>{let{field:i}=e;return(0,F.jsx)(p.Z,{labelId:"qtype-".concat(t),label:"Type",...i,children:V.map(((e,t)=>(0,F.jsx)(h.Z,{value:e,children:e},t)))})}})]}),(0,F.jsx)(a.Z,{variant:"outlined",onClick:()=>Oe("add",t),children:(0,F.jsx)(L.Z,{})}),(0,F.jsx)(a.Z,{disabled:0===t,variant:"outlined",onClick:()=>Oe("delete",t),children:(0,F.jsx)(O.Z,{})})]},t)})),(0,F.jsxs)(n.Z,{spacing:2,direction:"row",width:"100%",children:[(0,F.jsx)(u.Z,{fullWidth:!0,size:"small",...J("minOrder"),variant:"outlined",type:"number",label:"Minimum Order"}),Ze.length>0?(0,F.jsx)(u.Z,{fullWidth:!0,inputProps:{accept:".jpg, .jpeg, .png"},error:Boolean(null===K||void 0===K?void 0:K.image),helperText:(null===K||void 0===K?void 0:K.image)&&(null===(W=K.image)||void 0===W||null===(D=W.message)||void 0===D?void 0:D.toString()),size:"small",...J("image",{validate:{isImage:e=>{if(0===e.length)return!0;return!!["image/jpeg","image/jpg","image/png"].includes(e[0].type)||"Please upload a PNG or JPG image"}}}),variant:"outlined",type:"file"}):(0,F.jsx)(u.Z,{fullWidth:!0,inputProps:{accept:".jpg, .jpeg, .png"},error:Boolean(null===K||void 0===K?void 0:K.image),helperText:(null===K||void 0===K?void 0:K.image)&&(null===(R=K.image)||void 0===R||null===(G=R.message)||void 0===G?void 0:G.toString()),size:"small",...J("image",{required:"Image is mandatory",validate:{isImage:e=>{if(0===e.length)return!0;return!!["image/jpeg","image/jpg","image/png"].includes(e[0].type)||"Please upload a PNG or JPG image"}}}),variant:"outlined",type:"file"})]}),(0,F.jsxs)(n.Z,{spacing:2,direction:"row",width:"100%",children:[(0,F.jsx)(a.Z,{fullWidth:!0,onClick:()=>{Ze?ue(!1):ze()},variant:"contained",color:"error",disabled:Ze.length>0?ae:!X||ae,endIcon:ae&&(0,F.jsx)(y.Z,{color:"primary",size:20,thickness:6,sx:{color:"white"}}),children:"Cancel"}),(0,F.jsx)(a.Z,{fullWidth:!0,type:"submit",variant:"contained",disabled:Ze.length>0?ae:!X||ae,endIcon:ae&&(0,F.jsx)(y.Z,{color:"primary",size:20,thickness:6,sx:{color:"white"}}),children:"Submit"})]})]})})]})})}),le.open&&(0,F.jsx)(x.Z,{open:le.open,autoHideDuration:6e3,onClose:Pe,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:(0,F.jsx)(j.Z,{onClose:Pe,severity:le.severity,sx:{width:"100%"},children:le.message})}),(0,F.jsx)(U,{open:qe,onClose:Ie,dividers:!0,onConfirm:async()=>{try{oe(!0);const t=await(0,I.MZ)(Ze);if("Failed"===t.data.status)de({open:!0,severity:"error",message:t.data.message});else{de({open:!0,severity:"success",message:t.data.message});try{const e=await(0,I.w3)(pe);"Failed"===e.data.status?de({open:!0,severity:"error",message:e.data.message}):ye(e.data.productList)}catch(e){de({open:!1,severity:"warning",message:null===e||void 0===e?void 0:e.messsage})}}oe(!1),Ie()}catch(t){de({open:!1,severity:"warning",message:null===t||void 0===t?void 0:t.messsage}),oe(!1),Ie()}},title:"Confirm Action",children:(0,F.jsx)(Z.Z,{children:"Are you sure you want to delete this action?"})})]})}}}]);
//# sourceMappingURL=139.9057f0ae.chunk.js.map